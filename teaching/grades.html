


<!DOCTYPE html>
<html>
   <head>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta charset="utf-8">
      <meta name="author" content="Kevin Dusling" />
      <meta name="description" content="">
      <title>Course Grades</title>
      <link rel="stylesheet" href="/styles/foundation-icons.css" />
      <link rel='stylesheet' href='/styles/mystyle.css' />

   </head>
   <script src="https://use.fontawesome.com/3b9ab9ab70.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79202801-1', 'auto');
  ga('send', 'pageview');

</script>

</head>
<body>


   <script type="text/javascript" src="https://www.google.com/jsapi"></script>
   <script type="text/javascript">
     google.load('visualization', '1', {packages: ['corechart']});
   </script>



<span id="navbar_form">
    Select Course:
    <select name="course" id="course">
    <option id="MET212SPRING2018" value="1xkInSuKeM9MI1VHJiv5fu3BrCPTb5h-WBAVpyhrwBOI">MET 212 Spring 2018</option>
    <option id="MET201SPRING2018" value="115IzRzDr3e-jGvXeVrCskZe2EFNnHsVIOCTBOqiVYnU">MET 201 Spring 2018</option>
    </select>
    <BR><BR>
    Student ID: <input type="search" placeholder="R00000000" id="rid" />
    <BR><BR>
    <input type="button" id="navbar_submit" value="Submit" onClick="search_navigate()" />
</span>

<BR><BR>

<div id="display" style="width: 500px;"></div>


<script type="text/javascript">

window.onload=function(){
    document.getElementById(getQueryVariable("course")).selected = true;
}

function getQueryVariable(variable)
{
     var query = window.location.search.substring(1);
     var vars = query.split("&");
     for (var i=0;i<vars.length;i++) {
             var pair = vars[i].split("=");
             if(pair[0] == variable){return pair[1];}
     }
     return(false);
}

function search_navigate() {
      var course = document.getElementById("course").value;
      var rid = document.getElementById("rid").value;

      var query = new google.visualization.Query(
          "https://docs.google.com/spreadsheets/d/" + course + "/edit?usp=sharing"
      );

      query.setQuery("select * where C = '" + rid + "'");
      query.send(handleQueryResponse);


    }

    function handleQueryResponse(response) {
		if (response.isError()) {
        //alert('Error in query: ' + response.getMessage() + ' ' + response.getDetailedMessage());
          var dis = document.getElementById("display");
          dis.innerHTML = "Error in query ... please try again.";
        return;
      }

      var data = response.getDataTable();
      var nc = data.getNumberOfColumns();

      if ( data.getNumberOfRows() == 0 ){
        document.getElementById("display").innerHTML = "Error ... please try again.";
      } else {

        var myHTML = "<table style='width: 500px;'><tr>"
        for(i=2; i < nc; i++){
             myHTML += "<th>";
             myHTML +=  data.getColumnLabel(i);
             myHTML += "</th>";
            }
        myHTML += "</tr><tr>"
        for(i=2; i < nc; i++){
             myHTML += "<td align='center'>" + data.getValue(0,i) + "</td>";
            }
        myHTML += "</tr></table>"
        document.getElementById("display").innerHTML = myHTML;
      }
        return;
    }
</script>




<hr>
<div>
<a href="https://github.com/"><img style="vertical-align:middle" src="/images/Octocat.png" height="20"></a>
<span style=""><a href="http://kdusling.github.io/">Kevin Dusling</a> &nbsp;&nbsp; |
    &nbsp;&nbsp; <a href="/sitenav.html">site map</a> &nbsp;&nbsp; |
    &nbsp; &nbsp; last modified: 12-Apr-2018</span> 
</div>

</body>
</html>

